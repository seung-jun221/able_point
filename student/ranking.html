<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë­í‚¹ - í¬ì¸íŠ¸ ë±…í¬</title>

    <!-- Supabase & Config -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/api.js"></script>

    <!-- CSS (ìˆœì„œ ì¤‘ìš”!) -->
    <link rel="stylesheet" href="../assets/css/common.css" />
    <link rel="stylesheet" href="../assets/css/student.css" />
    <link rel="stylesheet" href="../assets/css/navigation.css" />
    <!-- í†µì¼ëœ ë„¤ë¹„ê²Œì´ì…˜ CSS ì¶”ê°€ -->
    <link rel="stylesheet" href="../assets/css/ranking.css" />
  </head>
  <body class="with-both-nav">
    <!-- ìƒí•˜ë‹¨ ë„¤ë¹„ í´ë˜ìŠ¤ ì¶”ê°€ -->

    <!-- í†µì¼ëœ ìƒë‹¨ í—¤ë” (app-header) -->
    <div class="app-header">
      <div class="header-user">
        <div class="header-avatar">
          <div class="header-avatar-inner" id="userAvatar">ğŸ¦</div>
        </div>
        <div class="header-name" id="userName">í•™ìƒ ì´ë¦„</div>
      </div>
      <div class="header-spacer"></div>
      <div class="header-actions">
        <div class="header-points" onclick="location.href='history.html'">
          <span class="header-points-icon">P</span>
          <span class="header-points-value" id="headerTotalPoints">0P</span>
        </div>
        <div class="header-notification" onclick="handleNotificationClick()">
          <span class="notification-icon">ğŸ””</span>
          <span class="notification-badge"></span>
        </div>
      </div>
    </div>

    <!-- ë­í‚¹ íƒ­ (ê¸°ì¡´ ìœ ì§€) -->
    <div class="ranking-tabs">
      <button class="ranking-tab active" data-tab="accumulated">
        <span>ğŸ’°</span>
        <span>í¬ì¸íŠ¸ ë­í‚¹</span>
      </button>
      <button class="ranking-tab" data-tab="weekly">
        <span>ğŸ†</span>
        <span>ì´ë²ˆì£¼ ìŠ¤íƒ€</span>
      </button>
    </div>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ (ê¸°ì¡´ ìœ ì§€) -->
    <div class="ranking-container">
      <!-- ë‚´ í˜„í™© ì¹´ë“œ -->
      <div class="my-status-card" id="myStatusCard">
        <!-- ë™ì  ìƒì„± -->
      </div>

      <!-- ë­í‚¹ ì½˜í…ì¸  -->
      <div id="rankingContent">
        <!-- ë™ì  ìƒì„± -->
      </div>
    </div>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (ë‹¤ë¥¸ í˜ì´ì§€ì™€ í†µì¼) -->
    <nav class="app-nav">
      <a href="index.html" class="nav-item" data-page="home">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">í™ˆ</span>
      </a>
      <a href="savings.html" class="nav-item" data-page="savings">
        <span class="nav-icon">ğŸ’°</span>
        <span class="nav-label">ì €ì¶•</span>
      </a>
      <a href="shop.html" class="nav-item" data-page="shop">
        <span class="nav-icon">ğŸ›ï¸</span>
        <span class="nav-label">ìƒì </span>
      </a>
      <a href="ranking.html" class="nav-item active" data-page="ranking">
        <span class="nav-icon">ğŸ†</span>
        <span class="nav-label">ë­í‚¹</span>
      </a>
      <a href="profile.html" class="nav-item" data-page="profile">
        <span class="nav-icon">ğŸ‘¤</span>
        <span class="nav-label">í”„ë¡œí•„</span>
      </a>
    </nav>

    <!-- JavaScript -->
    <script src="../assets/js/navigation.js"></script>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ê³µí†µ JS ì¶”ê°€ -->
    <script src="../assets/js/ranking.js"></script>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ í—¬í¼ í•¨ìˆ˜ (navigation.jsê°€ ì—†ì„ ê²½ìš° ëŒ€ë¹„) -->
    <script>
      // handleNavClick í•¨ìˆ˜ê°€ ì—†ìœ¼ë©´ ì •ì˜
      if (typeof handleNavClick === 'undefined') {
        function handleNavClick(page) {
          event.currentTarget.classList.add('nav-loading');

          setTimeout(() => {
            switch (page) {
              case 'home':
                window.location.href = 'index.html';
                break;
              case 'savings':
                window.location.href = 'savings.html';
                break;
              case 'shop':
                window.location.href = 'shop.html';
                break;
              case 'profile':
                window.location.href = 'profile.html';
                break;
            }
          }, 200);
        }
      }

      // handleNotificationClick í•¨ìˆ˜ê°€ ì—†ìœ¼ë©´ ì •ì˜
      if (typeof handleNotificationClick === 'undefined') {
        function handleNotificationClick() {
          // ì•Œë¦¼ í˜ì´ì§€ë¡œ ì´ë™ (ë˜ëŠ” ì•Œë¦¼ ëª¨ë‹¬ í‘œì‹œ)
          console.log('ì•Œë¦¼ í´ë¦­');
        }
      }

      // í—¤ë” ì •ë³´ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ranking.jsì™€ ì—°ë™)
      document.addEventListener('DOMContentLoaded', () => {
        // ë¡œê·¸ì¸ ì •ë³´ í™•ì¸
        const userName = localStorage.getItem('userName');
        const userAvatar = localStorage.getItem('userAvatar');
        const totalPoints = localStorage.getItem('totalPoints');

        // í—¤ë” ì—…ë°ì´íŠ¸
        if (userName) {
          document.getElementById('userName').textContent = userName;
        }
        if (userAvatar) {
          document.getElementById('userAvatar').textContent = userAvatar;
        }
        if (totalPoints) {
          document.getElementById('headerTotalPoints').textContent =
            parseInt(totalPoints).toLocaleString() + 'P';
        }
      });
    </script>
  </body>
</html>
