<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë­í‚¹ - í¬ì¸íŠ¸ ë±…í¬</title>

    <!-- Supabase & Config -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/api.js"></script>

    <!-- CSS (ìˆœì„œ ì¤‘ìš”!) -->
    <link rel="stylesheet" href="../assets/css/common.css" />
    <link rel="stylesheet" href="../assets/css/student.css" />
    <link rel="stylesheet" href="../assets/css/navigation.css" />
    <!-- í†µì¼ëœ ë„¤ë¹„ê²Œì´ì…˜ CSS ì¶”ê°€ -->
    <link rel="stylesheet" href="../assets/css/ranking.css" />
  </head>
  <body class="with-both-nav">
    <!-- ìƒí•˜ë‹¨ ë„¤ë¹„ í´ë˜ìŠ¤ ì¶”ê°€ -->

    <!-- í†µì¼ëœ ìƒë‹¨ í—¤ë” (app-header) -->
    <div class="app-header">
      <div class="header-user">
        <div class="header-avatar">
          <div class="header-avatar-inner" id="userAvatar">ğŸ¦</div>
        </div>
        <div class="header-name" id="userName">í•™ìƒ ì´ë¦„</div>
      </div>
      <div class="header-spacer"></div>
      <div class="header-actions">
        <div class="header-points" onclick="location.href='history.html'">
          <span class="header-points-icon">P</span>
          <span class="header-points-value" id="headerTotalPoints">0P</span>
        </div>
        <div class="header-notification" onclick="handleNotificationClick()">
          <span class="notification-icon">ğŸ””</span>
          <span class="notification-badge"></span>
        </div>
      </div>
    </div>

    <!-- ë­í‚¹ íƒ­ (ê¸°ì¡´ ìœ ì§€) -->
    <div class="ranking-tabs">
      <button class="ranking-tab active" data-tab="accumulated">
        <span>ğŸ’°</span>
        <span>í¬ì¸íŠ¸ ë­í‚¹</span>
      </button>
      <button class="ranking-tab" data-tab="weekly">
        <span>ğŸ†</span>
        <span>ì´ë²ˆì£¼ ìŠ¤íƒ€</span>
      </button>
    </div>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ (ê¸°ì¡´ ìœ ì§€) -->
    <div class="ranking-container">
      <!-- ë‚´ í˜„í™© ì¹´ë“œ -->
      <div class="my-status-card" id="myStatusCard">
        <!-- ë™ì  ìƒì„± -->
      </div>

      <!-- ë­í‚¹ ì½˜í…ì¸  -->
      <div id="rankingContent">
        <!-- ë™ì  ìƒì„± -->
      </div>
    </div>

    <!-- ë³€ê²½í•  ì½”ë“œ (SVG ë²„ì „) -->
    <nav class="app-nav">
      <a href="index.html" class="nav-item active" data-page="home">
        <span class="nav-icon">
          <svg viewBox="0 0 24 24" width="22" height="22">
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
            />
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M9 22V12h6v10"
            />
          </svg>
        </span>
        <span class="nav-label">í™ˆ</span>
      </a>

      <a href="savings.html" class="nav-item" data-page="savings">
        <span class="nav-icon">
          <svg viewBox="0 0 24 24" width="22" height="22">
            <path
              fill="currentColor"
              d="M19 5h-2V4c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v1H5c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zM9 4h6v1H9V4zm10 7H5c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h14c.55 0 1 .45 1 1v3c0 .55-.45 1-1 1z"
            />
            <path
              fill="currentColor"
              d="M4 12v8c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8H4zm8 4.5c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"
            />
          </svg>
        </span>
        <span class="nav-label">ì €ì¶•</span>
      </a>

      <a href="shop.html" class="nav-item" data-page="shop">
        <span class="nav-icon">
          <svg viewBox="0 0 24 24" width="22" height="22">
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"
            />
            <line
              stroke="currentColor"
              stroke-width="1.5"
              x1="3"
              y1="6"
              x2="21"
              y2="6"
            />
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M16 10a4 4 0 0 1-8 0"
            />
          </svg>
        </span>
        <span class="nav-label">ìƒì </span>
      </a>

      <a href="ranking.html" class="nav-item" data-page="ranking">
        <span class="nav-icon">
          <svg viewBox="0 0 24 24" width="22" height="22">
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M6 9H4.5a2.5 2.5 0 0 1 0-5C5.88 4 7 5.12 7 6.5V9zm0 0h12m0 0h1.5a2.5 2.5 0 0 0 0-5C18.12 4 17 5.12 17 6.5V9z"
            />
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M6 9v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V9M10 16h4"
            />
          </svg>
        </span>
        <span class="nav-label">ë­í‚¹</span>
      </a>

      <a href="profile.html" class="nav-item" data-page="profile">
        <span class="nav-icon">
          <svg viewBox="0 0 24 24" width="22" height="22">
            <path
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"
            />
            <circle
              stroke="currentColor"
              fill="none"
              stroke-width="1.5"
              cx="12"
              cy="7"
              r="4"
            />
          </svg>
        </span>
        <span class="nav-label">ë‚´ì •ë³´</span>
      </a>
    </nav>

    <!-- JavaScript -->
    <script src="../assets/js/navigation.js"></script>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ê³µí†µ JS ì¶”ê°€ -->
    <script src="../assets/js/ranking.js"></script>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ í—¬í¼ í•¨ìˆ˜ (navigation.jsê°€ ì—†ì„ ê²½ìš° ëŒ€ë¹„) -->
    <script>
      // handleNavClick í•¨ìˆ˜ê°€ ì—†ìœ¼ë©´ ì •ì˜
      if (typeof handleNavClick === 'undefined') {
        function handleNavClick(page) {
          event.currentTarget.classList.add('nav-loading');

          setTimeout(() => {
            switch (page) {
              case 'home':
                window.location.href = 'index.html';
                break;
              case 'savings':
                window.location.href = 'savings.html';
                break;
              case 'shop':
                window.location.href = 'shop.html';
                break;
              case 'profile':
                window.location.href = 'profile.html';
                break;
            }
          }, 200);
        }
      }

      // handleNotificationClick í•¨ìˆ˜ê°€ ì—†ìœ¼ë©´ ì •ì˜
      if (typeof handleNotificationClick === 'undefined') {
        function handleNotificationClick() {
          // ì•Œë¦¼ í˜ì´ì§€ë¡œ ì´ë™ (ë˜ëŠ” ì•Œë¦¼ ëª¨ë‹¬ í‘œì‹œ)
          console.log('ì•Œë¦¼ í´ë¦­');
        }
      }

      // í—¤ë” ì •ë³´ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ ranking.jsì™€ ì—°ë™)
      document.addEventListener('DOMContentLoaded', () => {
        // ë¡œê·¸ì¸ ì •ë³´ í™•ì¸
        const userName = localStorage.getItem('userName');
        const userAvatar = localStorage.getItem('userAvatar');
        const totalPoints = localStorage.getItem('totalPoints');

        // í—¤ë” ì—…ë°ì´íŠ¸
        if (userName) {
          document.getElementById('userName').textContent = userName;
        }
        if (userAvatar) {
          document.getElementById('userAvatar').textContent = userAvatar;
        }
        if (totalPoints) {
          document.getElementById('headerTotalPoints').textContent =
            parseInt(totalPoints).toLocaleString() + 'P';
        }
      });
    </script>
  </body>
</html>
