<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ν¬μΈνΈ λ±…ν¬ - μ„ μƒλ‹ κ΄€λ¦¬</title>
    <link rel="stylesheet" href="../assets/css/common.css" />
    <link rel="stylesheet" href="../assets/css/teacher.css" />
    <!-- teacher ν΄λ” μ•μ νμΌ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/config.js"></script>
    <!-- ../ μ£Όμ! -->
    <script src="../assets/js/api.js"></script>
    <!-- ../ μ£Όμ! -->

    <!-- β­ μƒλ΅ μ¶”κ°€: DataTables CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap4.min.css"
    />

    <!-- β­ μƒλ΅ μ¶”κ°€: Toastr (μ•λ¦Ό) CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
    />

    <style>
      /* Toastr μ»¤μ¤ν„°λ§μ΄μ§• */
      .toast-success {
        background-color: #22c55e !important;
      }

      .toast-error {
        background-color: #ef4444 !important;
      }

      .toast-warning {
        background-color: #f59e0b !important;
      }

      .toast-info {
        background-color: #6366f1 !important;
      }

      #toast-container > div {
        border-radius: 8px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
      }
    </style>
  </head>
  <body>
    <!-- μ‚¬μ΄λ“λ°” -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <div class="logo-icon">π¦</div>
          <span>ν¬μΈνΈ λ±…ν¬</span>
        </div>
        <select class="class-selector" id="classSelector">
          <option value="">μ „μ²΄ λ°</option>
          <option value="4A">μ΄λ“± 4-Aλ°</option>
          <option value="4B">μ΄λ“± 4-Bλ°</option>
          <option value="5A">μ΄λ“± 5-Aλ°</option>
          <option value="6A">μ΄λ“± 6-Aλ°</option>
        </select>
      </div>

      <nav class="nav-menu">
        <a href="#" class="nav-item active" data-page="dashboard">
          <span class="nav-icon">π“</span>
          <span>λ€μ‹λ³΄λ“</span>
        </a>
        <a href="#" class="nav-item" data-page="students">
          <span class="nav-icon">π‘¥</span>
          <span>ν•™μƒ κ΄€λ¦¬</span>
        </a>
        <a href="#" class="nav-item" data-page="points">
          <span class="nav-icon">π’°</span>
          <span>ν¬μΈνΈ μ§€κΈ‰</span>
        </a>
        <a href="#" class="nav-item" data-page="shop">
          <span class="nav-icon">π›οΈ</span>
          <span>ν¬μΈνΈμƒµ κ΄€λ¦¬</span>
        </a>
        <a href="#" class="nav-item" data-page="events">
          <span class="nav-icon">π―</span>
          <span>μ΄λ²¤νΈ κ΄€λ¦¬</span>
        </a>
        <a href="#" class="nav-item" data-page="ranking">
          <span class="nav-icon">π†</span>
          <span>λ­ν‚Ή κ΄€λ¦¬</span>
        </a>
        <a href="#" class="nav-item" data-page="reports">
          <span class="nav-icon">π“</span>
          <span>λ¦¬ν¬νΈ</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="teacher-profile">
          <div class="teacher-avatar">π‘©β€π«</div>
          <div class="teacher-info">
            <div class="teacher-name" id="teacherName">μ„ μƒλ‹</div>
            <div class="teacher-role">λ‹΄μ„ μ„ μƒλ‹</div>
          </div>
        </div>
        <button class="logout-btn" onclick="logout()">
          <span>π</span> λ΅κ·Έμ•„μ›ƒ
        </button>
      </div>
    </div>

    <!-- λ©”μΈ μ»¨ν…μΈ  -->
    <div class="main-content">
      <!-- νμ΄μ§€ ν—¤λ” -->
      <div class="page-header">
        <h1 class="page-title">λ€μ‹λ³΄λ“</h1>
        <p class="page-subtitle" id="todayDate">2024λ…„ 11μ›” 15μΌ κΈμ”μΌ</p>
      </div>

      <!-- μ”μ•½ μΉ΄λ“ -->
      <div class="summary-grid">
        <div class="summary-card">
          <div class="summary-icon icon-blue">π‘¥</div>
          <div class="summary-label">μ΄ ν•™μƒ μ</div>
          <div class="summary-value" id="totalStudents">0λ…</div>
          <div class="summary-change">μ „μ²΄ ν•™μƒ</div>
        </div>

        <div class="summary-card">
          <div class="summary-icon icon-green">π’°</div>
          <div class="summary-label">μ¤λ λ°ν–‰ ν¬μΈνΈ</div>
          <div class="summary-value" id="todayPoints">0P</div>
          <div class="summary-change">μ¤λ μ§€κΈ‰ν• ν¬μΈνΈ</div>
        </div>

        <div class="summary-card">
          <div class="summary-icon icon-purple">π†</div>
          <div class="summary-label">μ΄λ² μ£Ό 1λ“±</div>
          <div class="summary-value" id="weeklyTop">-</div>
          <div class="summary-change" id="weeklyTopPoints">0P νλ“</div>
        </div>

        <div class="summary-card">
          <div class="summary-icon icon-orange">π―</div>
          <div class="summary-label">λ‹¤μ μ΄λ²¤νΈ</div>
          <div class="summary-value">D-14</div>
          <div class="summary-change">μ›”κ°„ κ²½λ§¤</div>
        </div>
      </div>

      <!-- λΉ λ¥Έ μ•΅μ… -->
      <div class="quick-actions-grid">
        <div class="quick-action" onclick="quickAction('attendance')">
          <div class="quick-action-icon">β…</div>
          <div class="quick-action-label">μ¶μ„ ν¬μΈνΈ μ§€κΈ‰</div>
        </div>
        <div class="quick-action" onclick="quickAction('test')">
          <div class="quick-action-icon">π“</div>
          <div class="quick-action-label">μ‹ν— μ μ μ…λ ¥</div>
        </div>
        <div class="quick-action" onclick="quickAction('homework')">
          <div class="quick-action-icon">π“</div>
          <div class="quick-action-label">μ™μ  ν¬μΈνΈ</div>
        </div>
        <div class="quick-action" onclick="quickAction('interest')">
          <div class="quick-action-icon">π’</div>
          <div class="quick-action-label">μ΄μ μ •μ‚°</div>
        </div>
      </div>

      <!-- β­ μƒλ΅ μ¶”κ°€: μ°¨νΈ μ„Ήμ… -->
      <div
        class="charts-section"
        style="
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
          gap: 20px;
          margin: 30px 0;
        "
      >
        <div
          class="chart-card"
          style="
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
          "
        >
          <h3 style="font-size: 16px; margin-bottom: 20px; color: #333">
            π“ μ£Όκ°„ ν¬μΈνΈ λ°κΈ‰ ν„ν™©
          </h3>
          <canvas id="weeklyPointsChart"></canvas>
        </div>

        <div
          class="chart-card"
          style="
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
          "
        >
          <h3 style="font-size: 16px; margin-bottom: 20px; color: #333">
            π¥§ ν•™μƒλ³„ ν¬μΈνΈ λ¶„ν¬
          </h3>
          <canvas id="studentDistributionChart"></canvas>
        </div>

        <div
          class="chart-card"
          style="
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
          "
        >
          <h3 style="font-size: 16px; margin-bottom: 20px; color: #333">
            π“ μΉ΄ν…κ³ λ¦¬λ³„ ν¬μΈνΈ
          </h3>
          <canvas id="categoryChart"></canvas>
        </div>
      </div>

      <!-- ν•™μƒ λ©λ΅ ν…μ΄λΈ” -->
      <div class="table-section">
        <div class="table-header">
          <h2 class="table-title">ν•™μƒ ν¬μΈνΈ ν„ν™©</h2>
          <div class="table-actions">
            <input
              type="text"
              class="search-box"
              id="searchInput"
              placeholder="ν•™μƒ κ²€μƒ‰..."
            />
            <button class="btn btn-primary" onclick="showPointModal()">
              ν¬μΈνΈ μ§€κΈ‰
            </button>
          </div>
        </div>

        <table class="student-table" id="studentTable">
          <thead>
            <tr>
              <th>ν•™μƒ</th>
              <th>λ°</th>
              <th>λ λ²¨</th>
              <th>ν„μ¬ ν¬μΈνΈ</th>
              <th>μ €μ¶• ν¬μΈνΈ</th>
              <th>λΉ λ¥Έ μ§€κΈ‰</th>
            </tr>
          </thead>
          <tbody id="studentTableBody">
            <tr>
              <td colspan="6" style="text-align: center; padding: 40px">
                λ°μ΄ν„°λ¥Ό λ¶λ¬μ¤λ” μ¤‘...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ν¬μΈνΈ μ •μ±… κΈ°λ° μ§€κΈ‰ λ¨λ‹¬ -->
    <div id="pointModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>ν¬μΈνΈ μ§€κΈ‰/μ°¨κ°</h2>
          <button class="modal-close" onclick="closeModal()">Γ—</button>
        </div>

        <!-- ν•™λ…„ μ„ νƒ -->
        <div class="form-group">
          <label class="form-label">ν•™λ…„ κµ¬λ¶„</label>
          <select
            class="form-select"
            id="modalGradeSelect"
            onchange="updatePointOptions()"
          >
            <option value="elementary">μ΄λ“±ν•™μƒ</option>
            <option value="middle">μ¤‘ν•™μƒ</option>
          </select>
        </div>

        <!-- λ€μƒ ν•™μƒ -->
        <div class="form-group">
          <label class="form-label">λ€μƒ ν•™μƒ</label>
          <select class="form-select" id="modalStudentSelect">
            <option value="">ν•™μƒμ„ μ„ νƒν•μ„Έμ”</option>
          </select>
        </div>

        <!-- ν¬μΈνΈ μΉ΄ν…κ³ λ¦¬ -->
        <div class="form-group">
          <label class="form-label">μΉ΄ν…κ³ λ¦¬</label>
          <select
            class="form-select"
            id="modalCategorySelect"
            onchange="updatePointTypes()"
          >
            <option value="earn">νλ“ ν¬μΈνΈ</option>
            <option value="penalty">μ°¨κ° ν¬μΈνΈ</option>
          </select>
        </div>

        <!-- ν¬μΈνΈ μΆ…λ¥ -->
        <div class="form-group">
          <label class="form-label">ν¬μΈνΈ μΆ…λ¥</label>
          <select
            class="form-select"
            id="modalPointType"
            onchange="autoFillPoints()"
          >
            <!-- μµμ…μ€ JavaScriptλ΅ λ™μ  μƒμ„± -->
          </select>
        </div>

        <!-- ν¬μΈνΈ κΈμ•΅ -->
        <div class="form-group">
          <label class="form-label">ν¬μΈνΈ κΈμ•΅</label>
          <input
            type="number"
            class="form-input"
            id="modalPointAmount"
            placeholder="μλ™μΌλ΅ μ…λ ¥λ©λ‹λ‹¤"
          />
        </div>

        <!-- μ‚¬μ  -->
        <div class="form-group">
          <label class="form-label">μ¶”κ°€ μ‚¬μ  (μ„ νƒ)</label>
          <input
            type="text"
            class="form-input"
            id="modalPointReason"
            placeholder="μ: μν•™ μ‹ν— λ§μ "
          />
        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">μ·¨μ†</button>
          <button class="btn btn-primary" onclick="submitPoints()">
            μ§€κΈ‰/μ°¨κ°
          </button>
        </div>
      </div>
    </div>

    <!-- μΌκ΄„ μ²λ¦¬ λ¨λ‹¬ -->
    <div id="batchModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>μΌκ΄„ ν¬μΈνΈ μ²λ¦¬</h2>
          <button class="modal-close" onclick="closeBatchModal()">Γ—</button>
        </div>

        <div class="form-group">
          <label class="form-label">λ€μƒ</label>
          <select class="form-select" id="batchTarget">
            <option value="all">μ „μ²΄ ν•™μƒ</option>
            <option value="elementary">μ΄λ“±ν•™μƒ μ „μ²΄</option>
            <option value="middle">μ¤‘ν•™μƒ μ „μ²΄</option>
            <option value="class">νΉμ • λ°</option>
          </select>
        </div>

        <div class="form-group" id="classSelectGroup" style="display: none">
          <label class="form-label">λ° μ„ νƒ</label>
          <select class="form-select" id="batchClass">
            <option value="4A">μ΄λ“± 4-Aλ°</option>
            <option value="4B">μ΄λ“± 4-Bλ°</option>
            <option value="5A">μ΄λ“± 5-Aλ°</option>
            <option value="6A">μ΄λ“± 6-Aλ°</option>
            <option value="1A">μ¤‘λ“± 1-Aλ°</option>
            <option value="2A">μ¤‘λ“± 2-Aλ°</option>
            <option value="3A">μ¤‘λ“± 3-Aλ°</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">ν¬μΈνΈ μ ν•</label>
          <select class="form-select" id="batchType">
            <option value="homework">κ³Όμ  μ™„λ£ (μ΄λ“± 100P, μ¤‘λ“± 200P)</option>
            <option value="mathPerfect">μ—°μ‚° λ§μ  (μ΄λ“± 50P)</option>
            <option value="attendance">μ¶μ„ μ²΄ν¬ (10P)</option>
            <option value="custom">μ§μ ‘ μ…λ ¥</option>
          </select>
        </div>

        <div class="form-group" id="customPointGroup" style="display: none">
          <label class="form-label">ν¬μΈνΈ κΈμ•΅</label>
          <input
            type="number"
            class="form-input"
            id="batchAmount"
            placeholder="ν¬μΈνΈ μ…λ ¥"
          />
        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeBatchModal()">
            μ·¨μ†
          </button>
          <button class="btn btn-primary" onclick="processBatch()">
            μΌκ΄„ μ²λ¦¬
          </button>
        </div>
      </div>
    </div>

    <script>
      // ν¬μΈνΈ μ •μ±… μµμ… μ—…λ°μ΄νΈ
      function updatePointOptions() {
        const grade = document.getElementById('modalGradeSelect').value;
        const category = document.getElementById('modalCategorySelect').value;
        updatePointTypes();
      }

      function updatePointTypes() {
        const grade = document.getElementById('modalGradeSelect').value;
        const category = document.getElementById('modalCategorySelect').value;
        const typeSelect = document.getElementById('modalPointType');

        typeSelect.innerHTML = '';

        if (category === 'earn') {
          if (grade === 'elementary') {
            typeSelect.innerHTML = `
        <option value="mathPerfect" data-points="50">μ—°μ‚° λ§μ  (+50P)</option>
        <option value="tamdalSite" data-points="">νƒλ‹¬ μ‚¬κ³ λ ¥ (μ‹¤μ  ν¬μΈνΈ κ·Έλ€λ΅)</option>
        <option value="homework" data-points="100">κ³Όμ  μ™„λ£ (+100P)</option>
        <option value="levelTest" data-points="200">λ“±κΈ‰μ μ§€ν…μ¤νΈ ν†µκ³Ό (+200P)</option>
        <option value="writingExcellent" data-points="300">μ„μ ν• μ°μμ (+300P)</option>
        <option value="tantanComplete" data-points="300">νƒ„νƒ„λ¶ μ™„λ£ (+300P)</option>
        <option value="onlineComplete" data-points="500">μ¨λΌμΈ λ¬Έμ ν’€μ΄ μ™„λ£ (+500P)</option>
        <option value="makeupWork" data-points="200">κ²°μ„λ¶„ κ°€μ •ν•™μµ (+200P)</option>
        <option value="friendRecommend" data-points="10000">μ‹ κ·μƒ μΉκµ¬ μ¶”μ² (+10000P)</option>
        <option value="returnRecommend" data-points="30000">ν‡΄μ›μƒ μ¬λ“±μ› μ¶”μ² (+30000P)</option>
        <option value="teacherSpecial" data-points="">μ„ μƒλ‹ μ¬λ‰ νΉλ³„ν¬μΈνΈ (10-50P)</option>
      `;
          } else {
            typeSelect.innerHTML = `
        <option value="homework" data-points="200">κ³Όμ  μ™„λ£ (+200P)</option>
        <option value="levelTest" data-points="500">λ“±κΈ‰μ μ§€ν…μ¤νΈ ν†µκ³Ό (+500P)</option>
        <option value="writingExcellent" data-points="300">μ„μ ν• μ°μμ (+300P)</option>
        <option value="onlineComplete" data-points="1000">μ¨λΌμΈ λ¬Έμ ν’€μ΄ μ™„λ£ (+1000P)</option>
        <option value="makeupWork" data-points="200">κ²°μ„λ¶„ κ°€μ •ν•™μµ (+200P)</option>
        <option value="friendRecommend" data-points="10000">μ‹ κ·μƒ μΉκµ¬ μ¶”μ² (+10000P)</option>
        <option value="returnRecommend" data-points="30000">ν‡΄μ›μƒ μ¬λ“±μ› μ¶”μ² (+30000P)</option>
        <option value="teacherSpecial" data-points="">μ„ μƒλ‹ μ¬λ‰ νΉλ³„ν¬μΈνΈ (10-50P)</option>
      `;
          }
        } else {
          if (grade === 'elementary') {
            typeSelect.innerHTML = `
        <option value="noBook" data-points="-200">μ±… λ―Έμ§€μ°Έ (-200P)</option>
        <option value="noHomework" data-points="-500">κ³Όμ  λ―Έμ μ¶ (-500P)</option>
        <option value="badHomework" data-points="-300">κ³Όμ  λ¶μ„±μ‹¤ 50% μ΄μƒ μ¤λ‹µ (-300P)</option>
        <option value="mathTimeout" data-points="-50">μ—°μ‚° μ‹κ°„ μ΄κ³Ό 5λ¶„ (-50P)</option>
        <option value="behaviorWarning" data-points="">νƒλ„ λ¬Έμ  κ²½κ³  (μ¬λ‰)</option>
      `;
          } else {
            typeSelect.innerHTML = `
        <option value="noBook" data-points="-300">μ±… λ―Έμ§€μ°Έ (-300P)</option>
        <option value="noHomework" data-points="-500">κ³Όμ  λ―Έμ μ¶ (-500P)</option>
        <option value="badHomework" data-points="-300">κ³Όμ  λ¶μ„±μ‹¤ 50% μ΄μƒ μ¤λ‹µ (-300P)</option>
        <option value="behaviorWarning" data-points="">νƒλ„ λ¬Έμ  κ²½κ³  (μ¬λ‰)</option>
      `;
          }
        }
      }

      function autoFillPoints() {
        const typeSelect = document.getElementById('modalPointType');
        const selectedOption = typeSelect.options[typeSelect.selectedIndex];
        const points = selectedOption.getAttribute('data-points');

        if (points) {
          document.getElementById('modalPointAmount').value = Math.abs(points);
        } else {
          document.getElementById('modalPointAmount').value = '';
          document.getElementById('modalPointAmount').placeholder =
            'μ§μ ‘ μ…λ ¥ν•μ„Έμ”';
        }
      }

      // μΌκ΄„ μ²λ¦¬ λ€μƒ λ³€κ²½
      document
        .getElementById('batchTarget')
        ?.addEventListener('change', (e) => {
          const classGroup = document.getElementById('classSelectGroup');
          if (e.target.value === 'class') {
            classGroup.style.display = 'block';
          } else {
            classGroup.style.display = 'none';
          }
        });

      // μΌκ΄„ μ²λ¦¬ μ ν• λ³€κ²½
      document.getElementById('batchType')?.addEventListener('change', (e) => {
        const customGroup = document.getElementById('customPointGroup');
        if (e.target.value === 'custom') {
          customGroup.style.display = 'block';
        } else {
          customGroup.style.display = 'none';
        }
      });

      function closeBatchModal() {
        document.getElementById('batchModal').classList.remove('active');
      }

      // νμ΄μ§€ λ΅λ“μ‹ μ΄κΈ° μµμ… μ„¤μ •
      document.addEventListener('DOMContentLoaded', () => {
        updatePointTypes();
      });
    </script>

    <!-- β­ μ¤ν¬λ¦½νΈ μμ„ μ¤‘μ”! -->
    <!-- jQuery λ¨Όμ € -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- κ·Έ λ‹¤μ DataTables -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap4.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Toastr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <!-- κΈ°μ΅΄ μ¤ν¬λ¦½νΈ -->
    <script src="../assets/js/api.js"></script>
    <script src="../assets/js/teacher.js"></script>

    <!-- β­ μ°¨νΈ μ΄κΈ°ν™” μ¤ν¬λ¦½νΈ -->
    <script>
      // DataTables ν•κΈ€ μ„¤μ •
      const dataTableKorean = {
        lengthMenu: '_MENU_ λ…μ”© λ³΄κΈ°',
        zeroRecords: 'λ°μ΄ν„°κ°€ μ—†μµλ‹λ‹¤',
        info: 'μ „μ²΄ _TOTAL_λ… μ¤‘ _START_~_END_',
        infoEmpty: 'λ°μ΄ν„°κ°€ μ—†μµλ‹λ‹¤',
        infoFiltered: '(μ „μ²΄ _MAX_λ… μ¤‘ κ²€μƒ‰)',
        search: 'κ²€μƒ‰:',
        paginate: {
          first: 'μ²μ',
          last: 'λ§μ§€λ§‰',
          next: 'λ‹¤μ',
          previous: 'μ΄μ „',
        },
      };

      // νμ΄μ§€ λ΅λ“ μ‹ μ‹¤ν–‰
      document.addEventListener('DOMContentLoaded', function () {
        // DataTables μ΄κΈ°ν™” (ν…μ΄λΈ”μ— λ°μ΄ν„°κ°€ μμ„ λ•λ§)
        setTimeout(() => {
          if ($.fn.DataTable && $('#studentTableBody tr').length > 1) {
            $('#studentTable').DataTable({
              language: dataTableKorean,
              pageLength: 10,
              order: [[3, 'desc']], // ν¬μΈνΈ κΈ°μ¤€ μ •λ ¬
              responsive: true,
            });
          }
        }, 1000);

        // μ°¨νΈ μ΄κΈ°ν™”
        initCharts();
      });

      // μ°¨νΈ μ΄κΈ°ν™” ν•¨μ
      function initCharts() {
        // 1. μ£Όκ°„ ν¬μΈνΈ λ°κΈ‰ μ°¨νΈ
        const weeklyCtx = document
          .getElementById('weeklyPointsChart')
          .getContext('2d');
        new Chart(weeklyCtx, {
          type: 'line',
          data: {
            labels: ['μ›”', 'ν™”', 'μ', 'λ©', 'κΈ'],
            datasets: [
              {
                label: 'λ°κΈ‰ ν¬μΈνΈ',
                data: [120, 190, 300, 250, 420],
                borderColor: 'rgb(99, 102, 241)',
                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                tension: 0.4,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function (value) {
                    return value + 'P';
                  },
                },
              },
            },
          },
        });

        // 2. ν•™μƒλ³„ ν¬μΈνΈ λ¶„ν¬ μ°¨νΈ
        const distributionCtx = document
          .getElementById('studentDistributionChart')
          .getContext('2d');
        new Chart(distributionCtx, {
          type: 'doughnut',
          data: {
            labels: ['0-500P', '500-1000P', '1000-2000P', '2000P+'],
            datasets: [
              {
                data: [8, 12, 15, 5],
                backgroundColor: ['#fbbf24', '#34d399', '#60a5fa', '#a78bfa'],
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                position: 'bottom',
              },
            },
          },
        });

        // 3. μΉ΄ν…κ³ λ¦¬λ³„ ν¬μΈνΈ μ°¨νΈ
        const categoryCtx = document
          .getElementById('categoryChart')
          .getContext('2d');
        new Chart(categoryCtx, {
          type: 'bar',
          data: {
            labels: ['μ¶μ„', 'μ™μ ', 'μ‹ν—', 'νƒλ„', 'νΉλ³„'],
            datasets: [
              {
                label: 'ν¬μΈνΈ',
                data: [300, 450, 200, 150, 100],
                backgroundColor: [
                  '#6366f1',
                  '#22c55e',
                  '#f59e0b',
                  '#ef4444',
                  '#8b5cf6',
                ],
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function (value) {
                    return value + 'P';
                  },
                },
              },
            },
          },
        });
      }

      // μ°¨νΈ μ—…λ°μ΄νΈ ν•¨μ (teacher.jsμ—μ„ νΈμ¶μ©)
      function updateCharts() {
        // μ‹¤μ  λ°μ΄ν„°λ΅ μ°¨νΈ μ—…λ°μ΄νΈ
        const charts = Chart.instances;

        if (charts[0]) {
          // μ£Όκ°„ μ°¨νΈ μ—…λ°μ΄νΈ
          const today = new Date().getDay();
          const dayIndex = today === 0 ? 4 : today - 1;
          if (dayIndex >= 0 && dayIndex < 5) {
            charts[0].data.datasets[0].data[dayIndex] += 10;
            charts[0].update();
          }
        }
      }
    </script>
    <!-- κΈ°μ΅΄ μ¤ν¬λ¦½νΈλ“¤ μ•„λμ— μ¶”κ°€ -->
    <!-- DataTables Buttons Extension (μ—‘μ…€ λ‹¤μ΄λ΅λ“μ©) -->
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
  </body>
</html>
